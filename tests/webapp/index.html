<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OAuth 2.1 Test App</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container">
        <header>
            <h1>OAuth 2.1 Test App</h1>
            <p>Manually test all OAuth 2.1 flows</p>
        </header>

        <div class="main-layout">
            <!-- Left Column: Config + Flows -->
            <div class="left-column">

                <!-- Configuration -->
                <div class="config-section">
                    <h3>Configuration</h3>
                    <div class="config-row">
                        <input type="text" id="apiBaseUrl" placeholder="API Base URL">
                        <input type="text" id="clientId" placeholder="Client ID">
                        <input type="password" id="clientSecret" placeholder="Client Secret">
                        <input type="text" id="scopes" placeholder="Scopes">
                        <button onclick="updateConfig()">Save</button>
                    </div>
                </div>

                <!-- Current Tokens -->
                <div id="tokenDisplay"></div>

                <!-- Flows Grid -->
                <div class="flows-grid">

                    <!-- Authorization Code Flow -->
                    <div class="flow-card">
                        <h3>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4" />
                                <polyline points="10 17 15 12 10 7" />
                                <line x1="15" y1="12" x2="3" y2="12" />
                            </svg>
                            Authorization Code
                        </h3>
                        <p>Standard login with PKCE</p>
                        <button onclick="runFlow(this, () => startAuthorizationFlow())">Start Login</button>
                    </div>

                    <!-- Silent Auth -->
                    <div class="flow-card">
                        <h3>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10" />
                                <polyline points="12 6 12 12 16 14" />
                            </svg>
                            Silent Auth
                        </h3>
                        <p>Check session (prompt=none)</p>
                        <button onclick="runFlow(this, () => startAuthorizationFlow({ prompt: 'none' }))">Check
                            Session</button>
                    </div>

                    <!-- Force Re-auth -->
                    <div class="flow-card">
                        <h3>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="23 4 23 10 17 10" />
                                <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10" />
                            </svg>
                            Force Re-auth
                        </h3>
                        <p>Force new login</p>
                        <div class="options">
                            <select id="forceReauthMethod">
                                <option value="prompt">prompt=login</option>
                                <option value="maxAge">max_age=0</option>
                            </select>
                        </div>
                        <button
                            onclick="runFlow(this, () => startAuthorizationFlow(document.getElementById('forceReauthMethod').value === 'prompt' ? { prompt: 'login' } : { maxAge: 0 }))">Force
                            Login</button>
                    </div>

                    <!-- Refresh Token -->
                    <div class="flow-card">
                        <h3>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="1 4 1 10 7 10" />
                                <polyline points="23 20 23 14 17 14" />
                                <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15" />
                            </svg>
                            Refresh Token
                        </h3>
                        <p>Get new access token</p>
                        <button onclick="runFlow(this, refreshAccessToken)">Refresh</button>
                    </div>

                    <!-- Client Credentials -->
                    <div class="flow-card">
                        <h3>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="2" y="7" width="20" height="14" rx="2" ry="2" />
                                <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16" />
                            </svg>
                            Client Credentials
                            <span class="badge confidential">Secret</span>
                        </h3>
                        <p>Machine-to-machine</p>
                        <button onclick="runFlow(this, clientCredentialsFlow)">Get Token</button>
                    </div>

                    <!-- UserInfo -->
                    <div class="flow-card">
                        <h3>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                                <circle cx="12" cy="7" r="4" />
                            </svg>
                            UserInfo
                        </h3>
                        <p>Get user profile</p>
                        <button onclick="runFlow(this, getUserInfo)">Get Info</button>
                    </div>

                    <!-- Introspection -->
                    <div class="flow-card">
                        <h3>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="11" cy="11" r="8" />
                                <line x1="21" y1="21" x2="16.65" y2="16.65" />
                            </svg>
                            Introspect
                            <span class="badge confidential">Secret</span>
                        </h3>
                        <p>Validate token</p>
                        <button onclick="runFlow(this, introspectToken)">Introspect</button>
                    </div>

                    <!-- Revoke -->
                    <div class="flow-card">
                        <h3>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10" />
                                <line x1="15" y1="9" x2="9" y2="15" />
                                <line x1="9" y1="9" x2="15" y2="15" />
                            </svg>
                            Revoke
                        </h3>
                        <p>Invalidate token</p>
                        <div class="options">
                            <select id="revokeTokenType">
                                <option value="access">Access Token</option>
                                <option value="refresh">Refresh Token</option>
                            </select>
                        </div>
                        <button
                            onclick="runFlow(this, () => revokeToken(document.getElementById('revokeTokenType').value))">Revoke</button>
                    </div>

                    <!-- Logout -->
                    <div class="flow-card">
                        <h3>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                                <polyline points="16 17 21 12 16 7" />
                                <line x1="21" y1="12" x2="9" y2="12" />
                            </svg>
                            Logout
                        </h3>
                        <p>End session</p>
                        <button onclick="runFlow(this, logout)">Logout</button>
                    </div>

                    <!-- Discovery -->
                    <div class="flow-card">
                        <h3>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10" />
                                <line x1="2" y1="12" x2="22" y2="12" />
                                <path
                                    d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" />
                            </svg>
                            Discovery
                        </h3>
                        <p>OIDC configuration</p>
                        <button onclick="runFlow(this, fetchDiscovery)">Fetch</button>
                    </div>

                    <!-- JWKS -->
                    <div class="flow-card">
                        <h3>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                                <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                            </svg>
                            JWKS
                        </h3>
                        <p>Public keys</p>
                        <button onclick="runFlow(this, fetchJwks)">Fetch Keys</button>
                    </div>

                </div>
            </div>

            <!-- Right Column: Results -->
            <div class="right-column">
                <div class="results-section">
                    <h2>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12" />
                        </svg>
                        Activity Log
                    </h2>
                    <div id="resultsContainer"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>